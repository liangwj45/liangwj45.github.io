<!DOCTYPE html><html lang="zn"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="keywords" content="Wenjie Liang, 奥小文的加油站"><meta name="description"><title>Unity3D制作巡逻兵游戏</title><link rel="icon" href="/images/avatar.jpg?v=1.5.4" type="image/png" sizes="16x16"><link rel="icon" href="/images/avatar.jpg?v=1.5.4" type="image/png" sizes="32x32"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=1.5.4"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  fontawesome: {"prefix":"fa"},
  sidebar: {"offsetTop":"30px","renderTocDepth":4},
  header: {"scrollDownIcon":false},
  back2top: {"enable":true},
  reward: false,
  fancybox: false,
  zoom_image: {"enable":true,"mask_color":"rgba(0,0,0,0.6)"},
  gallery_waterfall: undefined,
  lazyload: undefined,
  pjax: undefined,
  external_link: {"icon":{"enable":true,"name":"external-link"}},
  shortcuts: {"switch_post":false},
  prompt: {"copy_success":"Copy Success","copy_error":"Copy Error","creative_commons":"Creative Commons","copy_button":"Click to Copy"}
};

window.CONFIG = CONFIG;</script></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav"><div class="header-nav-inner"><div class="header-nav-btn fa fa-bars"></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/"><i class="fa fa-home"></i>Home</a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/archives/"><i class="fa fa-folder-open"></i>Archives</a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/categories/"><i class="fa fa-th"></i>Categories</a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/tags/"><i class="fa fa-tags"></i>Tags</a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__a" href="/about/"><i class="fa fa-user"></i>About</a></div></div></div></nav><div class="header-info"><div class="header-info-inner"><div class="header-info-title">奥小文的加油站</div><div class="header-info-subtitle"></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content"><div class="post"><header class="post-header"><h1 class="post-header-title">Unity3D制作巡逻兵游戏</h1><div class="post-header-meta"><span class="post-header-meta-create"><i class="fa fa-calendar-o"></i><span>Posted </span><span>2019-12-26</span></span><span class="post-header-meta-reading-count"><i class="fa fa-eye"></i><span>Visited </span><span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body"><p>视频链接：<span class="external-link"><a href="https://www.bilibili.com/video/av74253695/" target="_blank" rel="noopener">https://www.bilibili.com/video/av74253695/</a><i class="fa fa-external-link"></i></span></p>
<p>项目地址：<span class="external-link"><a href="https://github.com/liangwj45/Unity-3D/tree/master/HW7/" target="_blank" rel="noopener">https://github.com/liangwj45/Unity-3D/tree/master/HW7/</a><i class="fa fa-external-link"></i></span></p>
<a id="more"></a>
<h2 id="游戏设计要求"><span class="heading-link">游戏设计要求</span></h2>
<ul>
<li>创建一个地图和若干巡逻兵(使用动画)；</li>
<li>每个巡逻兵走一个 3~5 个边的凸多边型，位置数据是相对地址。即每次确定下一个目标位置，用自己当前位置为原点计算；</li>
<li>巡逻兵碰撞到障碍物，则会自动选下一个点为目标；</li>
<li>巡逻兵在设定范围内感知到玩家，会自动追击玩家；</li>
<li>失去玩家目标后，继续巡逻；</li>
<li>计分：玩家每次甩掉一个巡逻兵计一分，与巡逻兵碰撞游戏结束；</li>
</ul>
<h2 id="游戏截图"><span class="heading-link">游戏截图</span></h2>
<p><img src="/img/Unity3D/Patrol/%E5%B7%A1%E9%80%BB%E5%85%B5.png" alt></p>
<h2 id="编写程序"><span class="heading-link">编写程序</span></h2>
<h3 id="map"><span class="heading-link">Map</span></h3>
<p>先在 Unity 上创建游戏地图以及游戏对象的预制，如栏杆，地板，游戏角色等。</p>
<p>然后用代码控制地图的生成以及游戏对象的放置。</p>
<figure class="highlight c#"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Map</span> :<span class="title">Object</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> GameObject planePrefab = Resources.Load&lt;GameObject&gt;(<span class="string">"Prefabs/Plane"</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> GameObject fencePrefab = Resources.Load&lt;GameObject&gt;(<span class="string">"Prefabs/Fence"</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> GameObject triggerPrefab = Resources.Load&lt;GameObject&gt;(<span class="string">"Prefabs/Trigger"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LoadMap</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        LoadPlane();</span><br><span class="line">        LoadFences();</span><br><span class="line">        LoadWalls();</span><br><span class="line">        LoadTriggers();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LoadPlane</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        GameObject plane = Instantiate(planePrefab);</span><br><span class="line">        plane.transform.position = <span class="keyword">new</span> Vector3(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LoadFences</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">int</span>[,] exist = &#123; &#123; <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span> &#125;, &#123; <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span> &#125; &#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">-13</span>; i &lt;= <span class="number">14</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">1</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (exist[j, i + <span class="number">13</span>] == <span class="number">1</span>) &#123;</span><br><span class="line">                    GameObject fence1 = Instantiate(fencePrefab);</span><br><span class="line">                    fence1.transform.position = <span class="keyword">new</span> Vector3(<span class="number">10</span> * j - <span class="number">5</span>, <span class="number">0</span>, (i - <span class="number">1</span>) * <span class="number">1.1f</span>);</span><br><span class="line">                    fence1.transform.rotation = Quaternion.Euler(<span class="number">0</span>, <span class="number">90</span>, <span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (exist[j, i + <span class="number">13</span>] == <span class="number">1</span>) &#123;</span><br><span class="line">                    GameObject fence2 = Instantiate(fencePrefab);</span><br><span class="line">                    fence2.transform.position = <span class="keyword">new</span> Vector3(i * <span class="number">1.1f</span>, <span class="number">0</span>, <span class="number">10</span> * j - <span class="number">5</span>);</span><br><span class="line">                    fence2.transform.rotation = Quaternion.Euler(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LoadWalls</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">-13</span>; i &lt;= <span class="number">14</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">1</span>; j++) &#123;</span><br><span class="line">                GameObject fence1 = Instantiate(fencePrefab);</span><br><span class="line">                fence1.transform.position = <span class="keyword">new</span> Vector3(<span class="number">30</span> * j - <span class="number">15</span>, <span class="number">0</span>, (i - <span class="number">1</span>) * <span class="number">1.1f</span>);</span><br><span class="line">                fence1.transform.rotation = Quaternion.Euler(<span class="number">0</span>, <span class="number">90</span>, <span class="number">0</span>);</span><br><span class="line">                GameObject fence2 = Instantiate(fencePrefab);</span><br><span class="line">                fence2.transform.position = <span class="keyword">new</span> Vector3(i * <span class="number">1.1f</span>, <span class="number">0</span>, <span class="number">30</span> * j - <span class="number">15</span>);</span><br><span class="line">                fence2.transform.rotation = Quaternion.Euler(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LoadTriggers</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">-10</span>, index = <span class="number">0</span>; i &lt;= <span class="number">10</span>; i += <span class="number">10</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">-10</span>; j &lt;= <span class="number">10</span>; j += <span class="number">10</span>) &#123;</span><br><span class="line">                GameObject trigger = Instantiate(triggerPrefab);</span><br><span class="line">                trigger.transform.position = <span class="keyword">new</span> Vector3(i, <span class="number">0</span>, j);</span><br><span class="line">                AreaCollider collider = trigger.AddComponent&lt;AreaCollider&gt;();</span><br><span class="line">                collider.sign = ++index;</span><br><span class="line">                trigger.name = <span class="string">"Trigger"</span> + index;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<h3 id="tracertaction"><span class="heading-link">TracertAction</span></h3>
<p>添加运动类，相比之前的 MoveToAction，多加了一个 TracertAction，即追随 Target 进行移动的方法。</p>
<figure class="highlight c#"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TracertAction</span> :<span class="title">Action</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> GameObject target;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">float</span> speed;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">TracertAction</span>(<span class="params"></span>)</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> TracertAction <span class="title">GetAction</span>(<span class="params">GameObject target, <span class="keyword">float</span> speed</span>)</span> &#123;</span><br><span class="line">        TracertAction action = ScriptableObject.CreateInstance&lt;TracertAction&gt;();</span><br><span class="line">        action.target = target;</span><br><span class="line">        action.speed = speed;</span><br><span class="line">        <span class="keyword">return</span> action;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        Quaternion rotation = Quaternion.LookRotation(target.transform.position - gameObject.transform.position, Vector3.up);</span><br><span class="line">        gameObject.transform.position = Vector3.MoveTowards(gameObject.transform.position, target.transform.position, speed * Time.deltaTime);</span><br><span class="line">        gameObject.transform.rotation = rotation;</span><br><span class="line">        <span class="keyword">if</span> (gameObject.transform.position == target.transform.position) &#123;</span><br><span class="line">            destroy = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span> &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<h3 id="gameactionmanager"><span class="heading-link">GameActionManager</span></h3>
<p>添加运动管理类，对巡逻兵的运动进行统一的管理，控制其巡逻或者追捕。</p>
<figure class="highlight c#"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GameActionManager</span> :<span class="title">ActionManager</span>, <span class="title">IActionCallback</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> GameObject player;</span><br><span class="line">    <span class="keyword">public</span> Dictionary&lt;<span class="keyword">int</span>, GameObject&gt; props;</span><br><span class="line">    <span class="keyword">public</span> Dictionary&lt;<span class="keyword">int</span>, Action&gt; tracert = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">int</span>, Action&gt;();</span><br><span class="line">    <span class="keyword">public</span> Dictionary&lt;<span class="keyword">int</span>, Action&gt; moveAround = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">int</span>, Action&gt;();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">float</span> speed = <span class="number">2f</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> room;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> System.Random rand = <span class="keyword">new</span> System.Random();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddPropMoves</span>(<span class="params"><span class="keyword">int</span> sign</span>)</span> &#123;</span><br><span class="line">        room = sign;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">9</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == sign) &#123;</span><br><span class="line">                tracert.Add(i, Tracert(props[i]));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                moveAround.Add(i, MoveAround(props[i], i));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetPlayerArea</span>(<span class="params"><span class="keyword">int</span> sign</span>)</span> &#123;</span><br><span class="line">        tracert[room].destroy = <span class="literal">true</span>;</span><br><span class="line">        tracert.Remove(room);</span><br><span class="line">        moveAround[room] = MoveAround(props[room], room);</span><br><span class="line">        room = sign;</span><br><span class="line">        moveAround[room].destroy = <span class="literal">true</span>;</span><br><span class="line">        moveAround.Remove(room);</span><br><span class="line">        tracert[room] = Tracert(props[room]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Action <span class="title">MoveAround</span>(<span class="params">GameObject prop, <span class="keyword">int</span> sign</span>)</span> &#123;</span><br><span class="line">        Vector3 position = <span class="keyword">new</span> Vector3((sign - <span class="number">1</span>) / <span class="number">3</span> * <span class="number">10</span> - <span class="number">10</span>, <span class="number">0</span>, (sign - <span class="number">1</span>) % <span class="number">3</span> * <span class="number">10</span> - <span class="number">10</span>);</span><br><span class="line">        Action action1 = MoveToAction.GetAction(<span class="keyword">new</span> Vector3(position.x - <span class="number">2f</span>, <span class="number">0</span>, position.z - <span class="number">2f</span>), speed);</span><br><span class="line">        Action action2 = MoveToAction.GetAction(<span class="keyword">new</span> Vector3(position.x - <span class="number">2f</span>, <span class="number">0</span>, position.z + <span class="number">2f</span>), speed);</span><br><span class="line">        Action action3 = MoveToAction.GetAction(<span class="keyword">new</span> Vector3(position.x + <span class="number">2f</span>, <span class="number">0</span>, position.z + <span class="number">2f</span>), speed);</span><br><span class="line">        Action action4 = MoveToAction.GetAction(<span class="keyword">new</span> Vector3(position.x + <span class="number">2f</span>, <span class="number">0</span>, position.z - <span class="number">2f</span>), speed);</span><br><span class="line">        Action sequence = SequenceAction.GetAction(<span class="number">-1</span>, <span class="number">0</span>, speed, <span class="keyword">new</span> List&lt;Action&gt; &#123; action1, action2, action3, action4 &#125;);</span><br><span class="line">        AddAction(prop, sequence, <span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">return</span> sequence;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Action <span class="title">Tracert</span>(<span class="params">GameObject prop</span>)</span> &#123;</span><br><span class="line">        Action action = TracertAction.GetAction(player, speed);</span><br><span class="line">        AddAction(prop, action, <span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">return</span> action;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">IActionCallback</span>(<span class="params">Action action</span>)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<h3 id="propfactory"><span class="heading-link">PropFactory</span></h3>
<p>巡逻兵的生产工厂。</p>
<figure class="highlight c#"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">PropFactory</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> PropFactory instance = <span class="keyword">new</span> PropFactory();</span><br><span class="line">    <span class="keyword">private</span> Dictionary&lt;<span class="keyword">int</span>, GameObject&gt; props = <span class="keyword">new</span> Dictionary&lt;<span class="keyword">int</span>, GameObject&gt;();</span><br><span class="line">    <span class="keyword">private</span> GameObject propPrefabs = Resources.Load&lt;GameObject&gt;(<span class="string">"Prefabs/Prop"</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> props_count = <span class="number">9</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">PropFactory</span>(<span class="params"></span>)</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> PropFactory <span class="title">GetInstance</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance ?? (instance = <span class="keyword">new</span> PropFactory());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dictionary&lt;<span class="keyword">int</span>, GameObject&gt; <span class="title">GetProps</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (props.Count == props_count) <span class="keyword">return</span> props;</span><br><span class="line">        <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">-10</span>; i &lt;= <span class="number">10</span>; i += <span class="number">10</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">-10</span>; j &lt;= <span class="number">10</span>; j += <span class="number">10</span>) &#123;</span><br><span class="line">                GameObject prop = Object.Instantiate(propPrefabs);</span><br><span class="line">                prop.transform.position = <span class="keyword">new</span> Vector3(i, <span class="number">0</span>, j);</span><br><span class="line">                prop.name = <span class="string">"Prop"</span> + (++index);</span><br><span class="line">                prop.AddComponent&lt;PlayerCollider&gt;();</span><br><span class="line">                props.Add(index, prop);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> props;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ResetAll</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (props.Count &lt; props_count) GetProps();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">-10</span>, index = <span class="number">0</span>; i &lt;= <span class="number">10</span>; i += <span class="number">10</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">-10</span>; j &lt;= <span class="number">10</span>; j += <span class="number">10</span>) &#123;</span><br><span class="line">                props[++index].transform.position = <span class="keyword">new</span> Vector3(i, <span class="number">0</span>, j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<h3 id="collider"><span class="heading-link">Collider</span></h3>
<p>碰撞相关的类，包括控制玩家进入方格，当前方格的切换，以及巡逻兵与玩家碰撞后游戏状态的改变。</p>
<figure class="highlight c#"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AreaCollider</span> :<span class="title">MonoBehaviour</span> &#123;</span><br><span class="line">    MainSceneController sceneController;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> sign = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        sceneController = Director.GetInstance().currentSceneController <span class="keyword">as</span> MainSceneController;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">OnTriggerEnter</span>(<span class="params">Collider collider</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (collider.gameObject.tag == <span class="string">"Player"</span>) &#123;</span><br><span class="line">            sceneController.SetPlayerArea(sign);</span><br><span class="line">            GameModel.GetInstance().PlayerEscape();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">PlayerCollider</span> :<span class="title">MonoBehaviour</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">OnCollisionEnter</span>(<span class="params">Collision other</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (other.gameObject.tag == <span class="string">"Player"</span>) &#123;</span><br><span class="line">            GameModel.GetInstance().GameOver();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<h3 id="mainscenecontroller"><span class="heading-link">MainSceneController</span></h3>
<p>游戏主体逻辑控制类。</p>
<figure class="highlight c#"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MainSceneController</span> :<span class="title">MonoBehaviour</span>, <span class="title">ISceneController</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> GameActionManager actionManager;</span><br><span class="line">    <span class="keyword">private</span> GameGUI gameGUI;</span><br><span class="line">    <span class="keyword">private</span> GameModel model;</span><br><span class="line">    <span class="keyword">private</span> GameObject player;</span><br><span class="line">    <span class="keyword">private</span> Dictionary&lt;<span class="keyword">int</span>, GameObject&gt; props;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> move_speed = <span class="number">4f</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> rotate_speed = <span class="number">50f</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Awake</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        actionManager = gameObject.AddComponent&lt;GameActionManager&gt;();</span><br><span class="line">        gameGUI = gameObject.AddComponent&lt;GameGUI&gt;();</span><br><span class="line">        gameGUI.onPressRestartButton += <span class="keyword">delegate</span> &#123;</span><br><span class="line">            Restart();</span><br><span class="line">            model.Restart();</span><br><span class="line">        &#125;;</span><br><span class="line">        model = GameModel.GetInstance();</span><br><span class="line">        model.onReFresh += <span class="keyword">delegate</span> &#123;</span><br><span class="line">            gameGUI.lose = model.lose;</span><br><span class="line">            gameGUI.score = model.score;</span><br><span class="line">        &#125;;</span><br><span class="line">        model.onGameover += <span class="keyword">delegate</span> &#123;</span><br><span class="line">            actionManager.StopAll();</span><br><span class="line">            player.GetComponent&lt;Animator&gt;().SetTrigger(<span class="string">"dead"</span>);</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> each <span class="keyword">in</span> props) &#123;</span><br><span class="line">                each.Value.GetComponent&lt;Animator&gt;().SetBool(<span class="string">"run"</span>, <span class="literal">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        Director.GetInstance().OnSceneWake(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        actionManager.AddPropMoves(<span class="number">5</span>);</span><br><span class="line">        Restart();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Restart</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        player.GetComponent&lt;Animator&gt;().Play(<span class="string">"New State"</span>);</span><br><span class="line">        player.transform.position = <span class="keyword">new</span> Vector3(<span class="number">3.5f</span>, <span class="number">0</span>, <span class="number">-2.5f</span>);</span><br><span class="line">        player.transform.rotation = Quaternion.Euler(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        PropFactory.GetInstance().ResetAll();</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> each <span class="keyword">in</span> props) &#123;</span><br><span class="line">            each.Value.GetComponent&lt;Animator&gt;().SetBool(<span class="string">"run"</span>, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        SetPlayerArea(<span class="number">5</span>);</span><br><span class="line">        actionManager.StartAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Update</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!model.lose) &#123;</span><br><span class="line">            PlayerMove();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">LoadResources</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        Map map = <span class="keyword">new</span> Map();</span><br><span class="line">        map.LoadMap();</span><br><span class="line">        player = Instantiate(Resources.Load&lt;GameObject&gt;(<span class="string">"Prefabs/Player"</span>));</span><br><span class="line">        player.transform.position = <span class="keyword">new</span> Vector3(<span class="number">3.5f</span>, <span class="number">0</span>, <span class="number">-2.5f</span>);</span><br><span class="line">        props = PropFactory.GetInstance().GetProps();</span><br><span class="line">        actionManager.player = player;</span><br><span class="line">        actionManager.props = props;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PlayerMove</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">float</span> translationX = Input.GetAxis(<span class="string">"Horizontal"</span>);</span><br><span class="line">        <span class="keyword">float</span> translationZ = Input.GetAxis(<span class="string">"Vertical"</span>);</span><br><span class="line">        <span class="keyword">if</span> (translationX != <span class="number">0</span> || translationZ != <span class="number">0</span>) &#123;</span><br><span class="line">            player.GetComponent&lt;Animator&gt;().SetBool(<span class="string">"run"</span>, <span class="literal">true</span>);</span><br><span class="line">            player.transform.Translate(<span class="number">0</span>, <span class="number">0</span>, translationZ * move_speed * Time.deltaTime);</span><br><span class="line">            player.transform.Rotate(<span class="number">0</span>, translationX * rotate_speed * Time.deltaTime, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (player.transform.localEulerAngles.x != <span class="number">0</span> || player.transform.localEulerAngles.z != <span class="number">0</span>) &#123;</span><br><span class="line">                player.transform.localEulerAngles = <span class="keyword">new</span> Vector3(<span class="number">0</span>, player.transform.localEulerAngles.y, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (player.transform.position.y != <span class="number">0</span>) &#123;</span><br><span class="line">                player.transform.position = <span class="keyword">new</span> Vector3(player.transform.position.x, <span class="number">0</span>, player.transform.position.z);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            player.GetComponent&lt;Animator&gt;().SetBool(<span class="string">"run"</span>, <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetPlayerArea</span>(<span class="params"><span class="keyword">int</span> sign</span>)</span> &#123;</span><br><span class="line">        actionManager.SetPlayerArea(sign);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
<h3 id="gamegui"><span class="heading-link">GameGUI</span></h3>
<p>游戏 UI。</p>
<figure class="highlight c#"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">GameGUI</span> :<span class="title">MonoBehaviour</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">bool</span> lose = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> score = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> EventHandler onPressDirectionKey;</span><br><span class="line">    <span class="keyword">public</span> EventHandler onPressRestartButton;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnGUI</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        GUI.Label(<span class="keyword">new</span> Rect(<span class="number">10</span>, Screen.height / <span class="number">2</span> - <span class="number">190</span>, <span class="number">200</span>, <span class="number">100</span>), <span class="string">"Score: "</span> + score, <span class="keyword">new</span> GUIStyle() &#123; fontSize = <span class="number">20</span> &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (lose) &#123;</span><br><span class="line">            GUI.Label(<span class="keyword">new</span> Rect(Screen.width / <span class="number">2</span> - <span class="number">50</span>, Screen.height / <span class="number">2</span> - <span class="number">50</span>, <span class="number">100</span>, <span class="number">50</span>), <span class="string">"You Lose!"</span>, <span class="keyword">new</span> GUIStyle() &#123; fontSize = <span class="number">40</span>, alignment = TextAnchor.MiddleCenter &#125;);</span><br><span class="line">            <span class="keyword">if</span> (GUI.Button(<span class="keyword">new</span> Rect(Screen.width / <span class="number">2</span> - <span class="number">70</span>, Screen.height / <span class="number">2</span>, <span class="number">140</span>, <span class="number">70</span>), <span class="string">"Restart"</span>, <span class="keyword">new</span> GUIStyle(<span class="string">"button"</span>) &#123; fontSize = <span class="number">30</span> &#125;)) &#123;</span><br><span class="line">                onPressRestartButton.Invoke(<span class="keyword">this</span>, EventArgs.Empty);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>
</div><footer class="post-footer"><div class="post-end"><span>------ </span><span>End of text, thank you for reading</span><span> ------</span></div><div class="post-tags"><span class="post-tags-item"><i class="post-tags-item__i fa fa-tags"></i><a class="post-tags-item__a" href="liangwj45.github.io/tags/动画/">动画</a></span></div><nav class="paginator"><div class="paginator-post"><div class="paginator-post-prev"><a class="paginator-post-prev__a" href="/2019/12/26/Unity3D制作打飞碟游戏（物理版）/"><i class="fa fa-chevron-left"></i><span>Unity3D制作打飞碟游戏（物理版）</span></a></div><div class="paginator-post-next"><a class="paginator-post-next__a" href="/2019/10/10/Unity3D制作打飞碟游戏/"><span>Unity3D制作打飞碟游戏</span><i class="fa fa-chevron-right"></i></a></div></div></nav></footer></div></div></div><aside class="sidebar" id="sidebar"><div class="sidebar-inner"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#游戏设计要求"><span class="toc-number">1.</span> <span class="toc-text">游戏设计要求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#游戏截图"><span class="toc-number">2.</span> <span class="toc-text">游戏截图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#编写程序"><span class="toc-number">3.</span> <span class="toc-text">编写程序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#map"><span class="toc-number">3.1.</span> <span class="toc-text">Map</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tracertaction"><span class="toc-number">3.2.</span> <span class="toc-text">TracertAction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gameactionmanager"><span class="toc-number">3.3.</span> <span class="toc-text">GameActionManager</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#propfactory"><span class="toc-number">3.4.</span> <span class="toc-text">PropFactory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#collider"><span class="toc-number">3.5.</span> <span class="toc-text">Collider</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mainscenecontroller"><span class="toc-number">3.6.</span> <span class="toc-text">MainSceneController</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gamegui"><span class="toc-number">3.7.</span> <span class="toc-text">GameGUI</span></a></li></ol></li></ol></div></section><!-- ov = overview --><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/avatar.jpg" alt="avatar"></div><p class="sidebar-ov-author__p">你今天吃早餐了吗？</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social__item" href="https://github.com/liangwj45" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><i class="sidebar-ov-social__item--icon fa fa-github"></i></a><a class="sidebar-ov-social__item" href="liangwj45@mail2.syu.edu.cn" target="_blank" rel="noopener" data-popover="Email" data-popover-pos="up"><i class="sidebar-ov-social__item--icon fa fa-envelope-o"></i></a><a class="sidebar-ov-social__item" href="290095633" target="_blank" rel="noopener" data-popover="QQ" data-popover-pos="up"><i class="sidebar-ov-social__item--icon fa fa-qq"></i></a></div><div class="sidebar-ov-state"><a class="sidebar-ov-state__a posts" href="/archives/"><div class="sidebar-ov-state__a--count">16</div><div class="sidebar-ov-state__a--name">Archives</div></a><a class="sidebar-ov-state__a categories" href="/categories/"><div class="sidebar-ov-state__a--count">3</div><div class="sidebar-ov-state__a--name">Categories</div></a><a class="sidebar-ov-state__a tags" href="/tags/"><div class="sidebar-ov-state__a--count">19</div><div class="sidebar-ov-state__a--name">Tags</div></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span>You have read </span><span class="sidebar-reading-info-num">0</span></div><div class="sidebar-reading-line"></div></div></div></aside><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>&copy; 2019</span><span> </span><span>Wenjie Liang.</span></div><div><span>Powered by <a href="http://hexo.io/" title="hexo" target="_blank" rel="noopener">hexo</a></span><span class="separator">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="stun" target="_blank" rel="noopener">stun</a></span></div><div class="busuanzi"><span class="busuanzi-site_pv"><i class="fa fa-eye"></i><span>Views </span><span id="busuanzi_value_site_pv"></span></span><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script></div></div></footer><div class="loading-bar" id="loading-bar"><div class="progress"></div></div><div class="back2top" id="back2top"><i class="back2top-icon fa fa-rocket"></i></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script><script src="/js/utils.js?v=1.5.4"></script><script src="/js/stun-boot.js?v=1.5.4"></script><script src="/js/scroll.js?v=1.5.4"></script><script src="/js/header.js?v=1.5.4"></script><script src="/js/sidebar.js?v=1.5.4"></script></body></html>